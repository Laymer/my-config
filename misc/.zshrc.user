if [[ ! ":$PATH:" =~ ":/usr/local/bin:" ]]; then
   export PATH="/usr/local/bin:$PATH"
fi

if [[ ! ":$PATH:" =~ ":/usr/local/sbin:" ]]; then
   export PATH="/usr/local/sbin:$PATH"
fi

if [[ ! ":$PATH:" =~ ":$HOME/bin:" ]]; then
   export PATH="$HOME/bin:$PATH"
fi

if [[ -z "$SHELL" ]]; then
    export SHELL=`command -v zsh`
fi

alias my-path="source my-path"
alias e="my-emacs -nw"
alias e-reset="emacsclient --alternate-editor=true -e '(kill-emacs)'"
alias g="git"
alias s="sudo"
alias o="open"
alias xclip="xclip -selection clipboard"
alias emacs="emacs -nw"
alias llt="ll --sort=time -r"

if type -p dircolors > /dev/null; then
    if [[ "$TERM" = dvtm || "$TERM" = dvtm-* ]]; then 
        eval `TERM=xterm${TERM#dvtm} dircolors`
    else
        eval `dircolors`
    fi
fi

local ret_status="%(?:%{$fg_bold[green]%}-> :%{$fg_bold[red]%}-> %s)"

PROMPT='${ret_status}%{$fg_bold[green]%}%p[${SSH_TTY:+%n@%m:}%j] %{$fg[cyan]%}%c %{$fg_bold[blue]%}$(git_prompt_info)%{$fg_bold[blue]%} % %{$reset_color%}'

ZSH_THEME_GIT_PROMPT_PREFIX="git:(%{$fg[red]%}"
ZSH_THEME_GIT_PROMPT_SUFFIX="%{$reset_color%}"
ZSH_THEME_GIT_PROMPT_DIRTY="%{$fg[blue]%}) %{$fg[yellow]%}(x)%{$reset_color%}"
ZSH_THEME_GIT_PROMPT_CLEAN="%{$fg[blue]%})"

setopt NO_HUP
setopt NO_CHECK_JOBS
setopt NO_SHARE_HISTORY

if [[ $TERM = "dumb" ]]; then
    unsetopt zle
    PS1='$ '
fi

bindkey "\e[1;3D"  backward-word
bindkey "\e[1;5D"  backward-word
bindkey "\e[1;3C"  forward-word
bindkey "\e[1;5C"  forward-word
bindkey "\e[47;5u" undo
bindkey "\e[47;7u" redo
bindkey "^W"       kill-region

if [[ -e "$HOME/.zshrc.user.os" ]]; then
   source "$HOME/.zshrc.user.os"
fi

preexec() {
  DATE=`date +"%H:%M:%S %Y-%m-%d"`
  C=$(($COLUMNS-22))
  echo -e "\033[1A\033[${C}C [${DATE}]"
  export TIME_PREEXEC=`date +%s`
}

precmd() {
  export TIME_PRECMD=`date +%s`
}
